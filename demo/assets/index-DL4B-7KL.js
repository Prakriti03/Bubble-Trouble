var N=Object.defineProperty;var R=(h,t,i)=>t in h?N(h,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):h[t]=i;var e=(h,t,i)=>R(h,typeof t!="symbol"?t+"":t,i);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const l of s)if(l.type==="childList")for(const m of l.addedNodes)m.tagName==="LINK"&&m.rel==="modulepreload"&&r(m)}).observe(document,{childList:!0,subtree:!0});function i(s){const l={};return s.integrity&&(l.integrity=s.integrity),s.referrerPolicy&&(l.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?l.credentials="include":s.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function r(s){if(s.ep)return;s.ep=!0;const l=i(s);fetch(s.href,l)}})();const H="/Bubble-Trouble/demo/background.png",_="/Bubble-Trouble/demo/bgImage2.jpeg",X="/Bubble-Trouble/demo/bgImage3.jpeg",a={CANVAS_HEIGHT:window.innerHeight-10,CANVAS_WIDTH:window.innerWidth-300},I={PLAYER_WIDTH:31,PLAYER_HEIGHT:55},C=.5,v=1.5,P=50,D=150,p=100,W=0,Y=60,U=.1,o=80,G={BUBBLE_CENTER_X:o+30,BUBBLE_CENTER_Y:250,BUBBLE_RADIUS:30,BG_IMG_SRC:H,BUBBLES_COUNT:1,isWallPresent:!1,LEVEL:1},O={BUBBLE_CENTER_X:o+60,BUBBLE_CENTER_Y:250,BUBBLE_RADIUS:60,BG_IMG_SRC:_,BUBBLES_COUNT:1,isWallPresent:!1,LEVEL:2},V={BUBBLE_CENTER_X_ONE:o+30,BUBBLE_CENTER_Y:250,BUBBLE_CENTER_X_TWO:800,BUBBLE_RADIUS_ONE:30,BUBBLE_RADIUS_TWO:50,BG_IMG_SRC:X,BUBBLES_COUNT:2,isWallPresent:!0,LEVEL:3};var n=(h=>(h.LEFT="Left",h.RIGHT="Right",h.STATIONARY="Stationary",h))(n||{}),b=(h=>(h.RUNNING="Running",h.PAUSED="Paused",h.END="End",h.WAITING="Waiting",h))(b||{});const L="/Bubble-Trouble/demo/wall.jpg",c=class c{constructor(t,i,r,s){e(this,"ctx");e(this,"wallImage");e(this,"disappearing",!1);e(this,"disappearingSpeed",10);c.posX=(a.CANVAS_WIDTH-o)/2,c.posY=i,c.width=r,c.height=s,this.ctx=t,this.wallImage=new Image,this.wallImage.src=L,console.log(`wall height og : ${s}`)}drawDefaultWalls(){this.ctx.drawImage(this.wallImage,0,0,o,a.CANVAS_HEIGHT),this.ctx.drawImage(this.wallImage,a.CANVAS_WIDTH-o,0,o,a.CANVAS_HEIGHT)}drawExtraWalls(){this.ctx.drawImage(this.wallImage,c.posX,0,o/2,c.height)}startDisappearing(){this.disappearing=!0}update(){this.disappearing&&c.height>0&&(c.height-=this.disappearingSpeed)}};e(c,"posX"),e(c,"posY"),e(c,"width"),e(c,"height");let u=c;const M="/Bubble-Trouble/demo/hero.png";class S{constructor(t){e(this,"heroImage");e(this,"ctx");e(this,"posX");e(this,"posY");e(this,"movement");e(this,"dx");e(this,"playerWidth");e(this,"playerHeight");e(this,"spriteWidth");e(this,"spriteHeight");e(this,"frameX");e(this,"frameY");e(this,"gameFrame");e(this,"staggerFrame");this.heroImage=new Image,this.heroImage.src=M,this.ctx=t,this.playerHeight=I.PLAYER_HEIGHT,this.playerWidth=I.PLAYER_WIDTH,this.posX=o,this.posY=a.CANVAS_HEIGHT-this.playerHeight-p,this.dx=3,this.movement=n.STATIONARY,this.spriteWidth=47.25,this.spriteHeight=56,this.frameX=0,this.frameY=0,this.gameFrame=0,this.staggerFrame=20}draw(){this.ctx.beginPath(),this.movement===n.STATIONARY&&this.ctx.drawImage(this.heroImage,8,112,31,55,this.posX,this.posY,this.playerWidth,this.playerHeight),this.movement===n.LEFT&&(this.ctx.drawImage(this.heroImage,this.frameX*this.spriteWidth,57,this.spriteWidth,this.spriteHeight,this.posX,this.posY,this.spriteWidth,this.spriteHeight),this.gameFrame%this.staggerFrame==0&&(this.frameX<3?this.frameX++:this.frameX=0),this.gameFrame++),this.movement===n.RIGHT&&(this.ctx.drawImage(this.heroImage,this.frameX*this.spriteWidth,0,this.spriteWidth,this.spriteHeight,this.posX,this.posY,this.spriteWidth,this.spriteHeight),this.gameFrame%this.staggerFrame==0&&(this.frameX<3?this.frameX++:this.frameX=0),this.gameFrame++),this.ctx.closePath()}update(t){this.movement===n.LEFT&&this.posX>=o&&(this.posX-=this.dx),t&&this.posX>=u.posX-this.playerWidth&&(this.posX-=this.dx),this.posX>=u.posX-this.playerWidth,this.movement===n.RIGHT&&this.posX+this.spriteWidth<=a.CANVAS_WIDTH-o&&(this.posX+=this.dx)}}class F{constructor(t){e(this,"posX");e(this,"posY");e(this,"width");e(this,"height");e(this,"ctx");e(this,"groundImg");this.ctx=t,this.posX=W,this.posY=a.CANVAS_HEIGHT-p,this.width=a.CANVAS_WIDTH,this.height=p,this.groundImg=new Image,this.groundImg.src=L}draw(t){this.ctx.beginPath(),this.ctx.drawImage(this.groundImg,this.posX,this.posY,this.width,this.height),this.ctx.closePath(),this.ctx.beginPath(),this.ctx.closePath(),this.drawTexts("Player 1",o,a.CANVAS_HEIGHT-10),this.drawTexts("Level",(a.CANVAS_WIDTH-o)/2,a.CANVAS_HEIGHT-50),this.drawTexts("Player 2",a.CANVAS_WIDTH-o-100,a.CANVAS_HEIGHT-10),this.drawTexts(t.toString(),(a.CANVAS_WIDTH-o)/2+25,a.CANVAS_HEIGHT-10)}drawTexts(t,i,r){this.ctx.font="24px Luckiest Guy",this.ctx.fillStyle="red";const s=t,m=this.ctx.measureText(s).width,A=parseInt(this.ctx.font,7),f=7,y=i-f,B=r-A-f,w=m+2*f,x=A+2*f;this.ctx.fillStyle="#D3D3D3",this.ctx.fillRect(y,B,w,x),this.ctx.strokeStyle="grey",this.ctx.lineWidth=3,this.ctx.strokeRect(y,B,w,x),this.ctx.fillStyle="red",this.ctx.fillText(s,i,r)}}const k="/Bubble-Trouble/demo/arrow.png";class ${constructor(t,i){e(this,"posX");e(this,"posY");e(this,"ctx");e(this,"player");e(this,"arrowImage");e(this,"isActive");e(this,"playerMovement");e(this,"bubbleArray");e(this,"isBubbleArrowCollisionTrue");e(this,"isHittable",!1);this.ctx=t,this.player=new S(t),this.posX=i+this.player.playerWidth/2,this.posY=a.CANVAS_HEIGHT-p,this.arrowImage=new Image,this.arrowImage.src=k,this.isActive=!0}draw(){this.isActive&&this.ctx.drawImage(this.arrowImage,this.posX,this.posY)}update(){this.posY<=0&&(this.isActive=!1),this.isActive&&(this.posY-=6)}checkCollision(t,i,r){return this.posX>=t-r&&this.posX<=t+r&&this.posY<=i+r}}class E{constructor(t,i,r,s,l){e(this,"ctx");e(this,"centerX");e(this,"centerY");e(this,"radius");e(this,"dy");e(this,"dx");e(this,"numberOfBubbles");e(this,"bubblePlayerDx");e(this,"bubblePlayerDy");e(this,"bubblePlayerDistance");e(this,"closestPlayerPosX");e(this,"closestPlayerPosY");e(this,"isBubbleArrowCollisionTrue");e(this,"isPlayerBubbleCollisionTrue");e(this,"mass");e(this,"gravity");this.ctx=t,this.centerX=s,this.centerY=l,this.radius=r,this.gravity=U,this.dy=C,this.dx=v,this.numberOfBubbles=i,this.mass=this.radius}getBallGradient(t,i,r){const s=this.ctx.createRadialGradient(this.centerX-this.radius/3,this.centerY-this.radius/3,this.radius/4,this.centerX,this.centerY,this.radius);return s.addColorStop(0,t),s.addColorStop(.5,i),s.addColorStop(1,r),s}draw(t,i){const r=this.getBallGradient("white","red","darkred");this.ctx.beginPath(),this.ctx.arc(t,i,this.radius,0,2*Math.PI,!1),this.ctx.fillStyle=r,this.ctx.fill(),this.ctx.closePath()}calculateInitialVelocity(t){return-4*(1+t/Y)}update(t,i){this.dy+=this.gravity,this.centerX+=this.dx,this.centerY+=this.dy,this.centerY+this.radius>=a.CANVAS_HEIGHT-p&&(this.centerY=a.CANVAS_HEIGHT-p-this.radius,this.dy=this.calculateInitialVelocity(this.radius)),(this.centerX+this.radius>=a.CANVAS_WIDTH-o||this.centerX-this.radius<=o)&&(this.dx*=-1),t&&(i&&console.log("bubble is at right side"),(this.centerX+this.radius>=u.posX&&this.centerX+this.radius<=u.posX+o/2||this.centerX-this.radius<=u.posX+o/2&&this.centerX+this.radius>u.posX)&&(this.dx*=-1))}checkCollision(t,i,r,s,l){this.closestPlayerPosX=Math.max(t,Math.min(r,t+I.PLAYER_WIDTH)),this.closestPlayerPosY=Math.max(i,Math.min(s,i+I.PLAYER_HEIGHT)),this.bubblePlayerDx=r-this.closestPlayerPosX,this.bubblePlayerDy=s-this.closestPlayerPosY,this.bubblePlayerDistance=Math.sqrt(this.bubblePlayerDx*this.bubblePlayerDx+this.bubblePlayerDy*this.bubblePlayerDy),this.bubblePlayerDistance<=l?this.isPlayerBubbleCollisionTrue=!0:this.isPlayerBubbleCollisionTrue=!1}splitBubbles(){this.radius/=2;const t=new E(this.ctx,this.numberOfBubbles,this.radius,this.centerX,this.centerY);t.centerX=this.centerX-this.radius,t.centerY=this.centerY,t.dx=-Math.abs(this.dx),t.dy=this.calculateInitialVelocity(this.radius)*.8;const i=new E(this.ctx,this.numberOfBubbles,this.radius,P,D);i.centerX=this.centerX+this.radius,i.centerY=this.centerY,i.dx=Math.abs(this.dx),i.dy=this.calculateInitialVelocity(this.radius)*.8;const r=g.bubbleArray.indexOf(this);r>=0&&r<g.bubbleArray.length&&g.bubbleArray.splice(r,1),g.bubbleArray.push(t,i)}}class q{constructor(t){e(this,"gameManager");e(this,"levels");e(this,"currentLevelIndex");e(this,"bubble");e(this,"level");this.gameManager=t,this.levels=[G,O,V],this.currentLevelIndex=0,this.level=1}loadLevel(t){const i=this.levels[t];this.applyLevelConfig(i),this.currentLevelIndex=t}loadNextLevel(){const t=this.currentLevelIndex+1;if(t<this.levels.length)this.level+=1,this.loadLevel(t),this.gameManager.resetTimer();else return}applyLevelConfig(t){this.gameManager.bgImage=new Image,this.gameManager.bgImage.src=t.BG_IMG_SRC,this.gameManager.level=t.LEVEL,this.gameManager.numberOfBubbles=t.BUBBLES_COUNT,g.bubbleArray=[],this.gameManager.isWallPresent=t.isWallPresent;for(let i=0;i<t.BUBBLES_COUNT;i++){const r=i===0?t.BUBBLE_RADIUS_ONE||t.BUBBLE_RADIUS:t.BUBBLE_RADIUS_TWO||t.BUBBLE_RADIUS,s=i===0?t.BUBBLE_CENTER_X_ONE||t.BUBBLE_CENTER_X:t.BUBBLE_CENTER_X_TWO||t.BUBBLE_CENTER_X;s>=u.posX+o&&(this.gameManager.isBubbleToWallRight=!0),this.bubble=new E(this.gameManager.ctx,i,r,s,t.BUBBLE_CENTER_Y),g.bubbleArray.push(this.bubble)}this.gameManager.initialSetup()}}const d=class d{constructor(t){e(this,"canvas");e(this,"ctx");e(this,"player");e(this,"x");e(this,"y");e(this,"bgImage");e(this,"bubble");e(this,"ground");e(this,"gameState");e(this,"bubblePlayerDx");e(this,"bubblePlayerDy");e(this,"bubblePlayerDistance");e(this,"bubbleArrowDx");e(this,"bubbleArrowDy");e(this,"bubbleArrowDistance");e(this,"arrow");e(this,"arrowActive");e(this,"numberOfBubbles");e(this,"bubbleRadius");e(this,"tempMovement");e(this,"isBubbleArrowCollisionTrue");e(this,"levelLoader");e(this,"timeLimit");e(this,"elapsedTime");e(this,"startTime");e(this,"timeRemaining");e(this,"level");e(this,"wall");e(this,"isWallPresent",!1);e(this,"isBubbleToWallRight",!1);this.canvas=t,this.ctx=this.canvas.getContext("2d"),this.canvas.width=a.CANVAS_WIDTH,this.canvas.height=a.CANVAS_HEIGHT,this.levelLoader=new q(this),this.x=0,this.y=0,this.gameState=b.RUNNING,this.bgImage=new Image,this.numberOfBubbles=1,d.bubbleArray=[],this.arrowActive=!1,this.tempMovement=n.STATIONARY,this.timeLimit=40*1e3,this.startTime=Date.now(),this.timeRemaining=this.timeLimit,this.elapsedTime=0,this.level=1,this.levelLoader.loadLevel(0),this.start(),document.addEventListener("keydown",i=>{i.code==="ArrowLeft"&&(this.player.movement=n.LEFT,this.tempMovement=n.LEFT),i.code==="ArrowRight"&&(this.player.movement=n.RIGHT,this.tempMovement=n.RIGHT)}),document.addEventListener("keyup",i=>{(i.code==="ArrowLeft"||i.code==="ArrowRight")&&(this.player.movement=n.STATIONARY,this.tempMovement=n.STATIONARY)}),document.addEventListener("keydown",i=>{i.code==="Space"&&(this.arrow=new $(this.ctx,this.player.posX),this.arrow.isHittable=!0,this.player.movement=n.STATIONARY)}),document.addEventListener("keyup",i=>{i.code==="Space"&&(this.player.movement=this.tempMovement)})}initialSetup(){this.player=new S(this.ctx),this.ground=new F(this.ctx),this.wall=new u(this.ctx,0,0,a.CANVAS_HEIGHT-p)}draw(){switch(this.gameState){case b.RUNNING:this.runningStateRender();break;case b.END:this.endGameStateRender();break}}runningStateRender(){var t,i,r,s,l,m;this.ctx.clearRect(this.x,this.y,a.CANVAS_WIDTH,a.CANVAS_HEIGHT),this.ctx.drawImage(this.bgImage,this.x,this.y,this.canvas.width,this.canvas.height),(t=this.arrow)==null||t.draw(),(i=this.player)==null||i.draw(),d.bubbleArray.forEach(A=>{console.log(`${d.bubbleArray.length}`),A.draw(A.centerX,A.centerY)}),(r=this.wall)==null||r.drawDefaultWalls(),(s=this.ground)==null||s.draw(this.level),this.isWallPresent&&((l=this.wall)==null||l.drawExtraWalls()),this.drawTimer(),((m=d.bubbleArray)==null?void 0:m.length)==0&&(this.level+=1,this.levelLoader.loadNextLevel())}drawTimer(){const t=Math.floor(this.timeRemaining/6e4),i=Math.floor(this.timeRemaining%6e4/1e3),r=`${t}:${i<10?"0":""}${i}`;this.ctx.font="24px Arial",this.ctx.fillStyle="white",this.ctx.fillText(r,this.canvas.width-100,50)}resetTimer(){this.startTime=Date.now(),this.elapsedTime=0,this.timeRemaining=this.timeLimit}waitingStateRender(){this.gameState=b.WAITING,this.ctx.fillStyle="red",this.ctx.fillRect(100,100,100,100),this.levelLoader.loadNextLevel()}checkCollision(){d.bubbleArray.forEach(t=>{t.checkCollision(this.player.posX,this.player.posY,t.centerX,t.centerY,t.radius),t.isPlayerBubbleCollisionTrue&&(this.gameState=b.END,this.endGameStateRender())}),d.bubbleArray.forEach(t=>{var i;t.isBubbleArrowCollisionTrue=(i=this.arrow)==null?void 0:i.checkCollision(t.centerX,t.centerY,t.radius)})}endGameStateRender(){this.gameState=b.END,this.ctx.fillStyle="green",this.ctx.fillRect(100,100,100,100)}update(){var t,i,r;this.gameState===b.RUNNING&&(this.elapsedTime=Date.now()-this.startTime,this.timeRemaining=this.timeLimit-this.elapsedTime,this.timeRemaining<=0&&(this.gameState=b.END,this.endGameStateRender()),u.height<=0&&(this.isWallPresent=!1),(t=this.player)==null||t.update(this.isWallPresent),d.bubbleArray.forEach((s,l)=>{var m;s.isBubbleArrowCollisionTrue&&this.arrow.isHittable&&this.arrow.isActive&&(s.radius<10?(m=d.bubbleArray)==null||m.splice(l,1):s.splitBubbles(),this.arrow.isActive=!1,this.arrow.isHittable=!1)}),d.bubbleArray.forEach(s=>{s.update(this.isWallPresent,this.isBubbleToWallRight)}),(i=this.arrow)==null||i.update(),this.checkBubblesOnPlayerSide(),(r=this.wall)==null||r.update())}checkBubblesOnPlayerSide(){var i;let t=!0;for(let r of d.bubbleArray)if(r.centerX<=u.posX){t=!1;break}t&&((i=this.wall)==null||i.startDisappearing())}start(){this.checkCollision(),this.update(),this.draw(),this.start=this.start.bind(this),requestAnimationFrame(this.start)}};e(d,"bubbleArray");let g=d;const T=document.querySelector("#canvas");T.width=a.CANVAS_WIDTH;T.height=a.CANVAS_HEIGHT;T.style.border="1px solid black";new g(T);
