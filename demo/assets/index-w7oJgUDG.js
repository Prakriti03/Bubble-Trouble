var y=Object.defineProperty;var I=(a,e,i)=>e in a?y(a,e,{enumerable:!0,configurable:!0,writable:!0,value:i}):a[e]=i;var t=(a,e,i)=>I(a,typeof e!="symbol"?e+"":e,i);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))s(r);new MutationObserver(r=>{for(const h of r)if(h.type==="childList")for(const p of h.addedNodes)p.tagName==="LINK"&&p.rel==="modulepreload"&&s(p)}).observe(document,{childList:!0,subtree:!0});function i(r){const h={};return r.integrity&&(h.integrity=r.integrity),r.referrerPolicy&&(h.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?h.credentials="include":r.crossOrigin==="anonymous"?h.credentials="omit":h.credentials="same-origin",h}function s(r){if(r.ep)return;r.ep=!0;const h=i(r);fetch(r.href,h)}})();const f="/Bubble-Trouble/demo/background.png",T="/Bubble-Trouble/demo/bgImage2.jpeg",B="/Bubble-Trouble/demo/bgImage3.jpeg",o={CANVAS_HEIGHT:window.innerHeight-10,CANVAS_WIDTH:window.innerWidth-300},b={PLAYER_WIDTH:31,PLAYER_HEIGHT:55},E=3,w=2,L=50,x=150,d=100,S=0,N=60,_=.4,m=40,R={BUBBLE_CENTER_X:m+30,BUBBLE_CENTER_Y:250,BUBBLE_RADIUS:30,BG_IMG_SRC:f,BUBBLES_COUNT:1},v={BUBBLE_CENTER_X:m+60,BUBBLE_CENTER_Y:250,BUBBLE_RADIUS:60,BG_IMG_SRC:T,BUBBLES_COUNT:1},H={BUBBLE_CENTER_X:m+25,BUBBLE_CENTER_Y:250,BUBBLE_RADIUS_ONE:50,BUBBLE_RADIUS_TWO:30,BG_IMG_SRC:B,BUBBLES_COUNT:2},C="/Bubble-Trouble/demo/hero.png";var n=(a=>(a.LEFT="Left",a.RIGHT="Right",a.STATIONARY="Stationary",a))(n||{}),l=(a=>(a.RUNNING="Running",a.PAUSED="Paused",a.END="End",a.WAITING="Waiting",a))(l||{});class A{constructor(e){t(this,"heroImage");t(this,"ctx");t(this,"posX");t(this,"posY");t(this,"movement");t(this,"dx");t(this,"playerWidth");t(this,"playerHeight");t(this,"spriteWidth");t(this,"spriteHeight");t(this,"frameX");t(this,"frameY");t(this,"gameFrame");t(this,"staggerFrame");this.heroImage=new Image,this.heroImage.src=C,this.ctx=e,this.playerHeight=b.PLAYER_HEIGHT,this.playerWidth=b.PLAYER_WIDTH,this.posX=o.CANVAS_WIDTH/2-this.playerWidth,this.posY=o.CANVAS_HEIGHT-this.playerHeight-d,this.dx=5,this.movement=n.STATIONARY,this.spriteWidth=47.25,this.spriteHeight=56,this.frameX=0,this.frameY=0,this.gameFrame=0,this.staggerFrame=15}draw(){this.ctx.beginPath(),this.movement===n.STATIONARY&&this.ctx.drawImage(this.heroImage,8,112,31,55,this.posX,this.posY,this.playerWidth,this.playerHeight),this.movement===n.LEFT&&(this.ctx.drawImage(this.heroImage,this.frameX*this.spriteWidth,57,this.spriteWidth,this.spriteHeight,this.posX,this.posY,this.spriteWidth,this.spriteHeight),this.gameFrame%this.staggerFrame==0&&(this.frameX<3?this.frameX++:this.frameX=0),this.gameFrame++),this.movement===n.RIGHT&&(this.ctx.drawImage(this.heroImage,this.frameX*this.spriteWidth,0,this.spriteWidth,this.spriteHeight,this.posX,this.posY,this.spriteWidth,this.spriteHeight),this.gameFrame%this.staggerFrame==0&&(this.frameX<3?this.frameX++:this.frameX=0),this.gameFrame++),this.ctx.closePath()}update(){this.movement===n.LEFT&&this.posX>=0&&(this.posX-=this.dx),this.movement===n.RIGHT&&this.posX+this.spriteWidth<=o.CANVAS_WIDTH&&(this.posX+=this.dx)}}const c=class c{constructor(e,i,s,r,h){t(this,"ctx");t(this,"centerX");t(this,"centerY");t(this,"radius");t(this,"dy");t(this,"dx");t(this,"numberOfBubbles");t(this,"bubblePlayerDx");t(this,"bubblePlayerDy");t(this,"bubblePlayerDistance");t(this,"closestPlayerPosX");t(this,"closestPlayerPosY");t(this,"isBubbleArrowCollisionTrue");t(this,"isPlayerBubbleCollisionTrue");t(this,"mass");t(this,"gravity");this.ctx=e,this.centerX=r,this.centerY=h,this.radius=s,this.gravity=_,this.dy=E,this.dx=w,this.numberOfBubbles=i,this.mass=this.radius}draw(e,i){const s=this.ctx.createRadialGradient(this.centerX-this.radius/3,this.centerY-this.radius/3,this.radius/4,this.centerX,this.centerY,this.radius);s.addColorStop(0,"white"),s.addColorStop(.5,"red"),s.addColorStop(1,"darkred"),this.ctx.beginPath(),this.ctx.arc(e,i,this.radius,0,2*Math.PI,!1),this.ctx.fillStyle=s,this.ctx.fill(),this.ctx.closePath()}calculateInitialVelocity(e){return-9*(1+e/N)}update(){this.dy+=this.gravity,this.centerX+=this.dx,this.centerY+=this.dy,this.centerY+this.radius>=o.CANVAS_HEIGHT-d&&(this.centerY=o.CANVAS_HEIGHT-d-this.radius,this.dy=this.calculateInitialVelocity(this.radius)),(this.centerX+this.radius>=o.CANVAS_WIDTH-m||this.centerX-this.radius<=m)&&(this.dx*=-1)}checkCollision(e,i,s,r,h){this.closestPlayerPosX=Math.max(e,Math.min(s,e+b.PLAYER_WIDTH)),this.closestPlayerPosY=Math.max(i,Math.min(r,i+b.PLAYER_HEIGHT)),this.bubblePlayerDx=s-this.closestPlayerPosX,this.bubblePlayerDy=r-this.closestPlayerPosY,this.bubblePlayerDistance=Math.sqrt(this.bubblePlayerDx*this.bubblePlayerDx+this.bubblePlayerDy*this.bubblePlayerDy),this.bubblePlayerDistance<=h?this.isPlayerBubbleCollisionTrue=!0:this.isPlayerBubbleCollisionTrue=!1}splitBubbles(){this.radius/=2;const e=new c(this.ctx,this.numberOfBubbles,this.radius,this.centerX,this.centerY);e.centerX=this.centerX-this.radius,e.centerY=this.centerY,e.dx=-Math.abs(this.dx),e.dy=this.calculateInitialVelocity(this.radius)*.7;const i=new c(this.ctx,this.numberOfBubbles,this.radius,L,x);i.centerX=this.centerX+this.radius,i.centerY=this.centerY,i.dx=Math.abs(this.dx),i.dy=this.calculateInitialVelocity(this.radius)*.7;const s=c.bubbleArray.indexOf(this);s>=0&&s<c.bubbleArray.length&&c.bubbleArray.splice(s,1),c.bubbleArray.push(e,i)}};t(c,"bubbleArray",[]);let u=c;const D="/Bubble-Trouble/demo/wall.jpg";class Y{constructor(e){t(this,"posX");t(this,"posY");t(this,"width");t(this,"height");t(this,"ctx");t(this,"groundImg");this.ctx=e,this.posX=S,this.posY=o.CANVAS_HEIGHT-d,this.width=o.CANVAS_WIDTH,this.height=d,this.groundImg=new Image,this.groundImg.src=D}draw(){this.ctx.beginPath(),this.ctx.drawImage(this.groundImg,0,0,40,o.CANVAS_HEIGHT),this.ctx.drawImage(this.groundImg,o.CANVAS_WIDTH-40,0,40,o.CANVAS_HEIGHT),this.ctx.drawImage(this.groundImg,this.posX,this.posY,this.width,this.height),this.ctx.closePath(),this.ctx.beginPath(),this.ctx.closePath()}}const X="/Bubble-Trouble/demo/arrow.png";class P{constructor(e,i){t(this,"posX");t(this,"posY");t(this,"ctx");t(this,"player");t(this,"arrowImage");t(this,"isActive");t(this,"playerMovement");t(this,"bubbleArray");t(this,"isBubbleArrowCollisionTrue");t(this,"isHittable",!1);this.ctx=e,this.player=new A(e),this.posX=i+this.player.playerWidth/2,this.posY=o.CANVAS_HEIGHT-d,this.arrowImage=new Image,this.arrowImage.src=X,this.isActive=!0}draw(){this.isActive&&this.ctx.drawImage(this.arrowImage,this.posX,this.posY)}update(){this.posY<=0&&(this.isActive=!1),this.isActive&&(this.posY-=5)}checkCollision(e,i,s){return this.posX>=e-s&&this.posX<=e+s&&this.posY<=i+s}}class U{constructor(e){t(this,"gameManager");t(this,"levels");t(this,"currentLevelIndex");t(this,"bubble");this.gameManager=e,this.levels=[R,v,H],this.currentLevelIndex=0}loadLevel(e){const i=this.levels[e];this.applyLevelConfig(i),this.currentLevelIndex=e}loadNextLevel(){const e=this.currentLevelIndex+1;if(e<this.levels.length)this.loadLevel(e),this.gameManager.resetTimer();else return}applyLevelConfig(e){this.gameManager.bgImage=new Image,this.gameManager.bgImage.src=e.BG_IMG_SRC,this.gameManager.numberOfBubbles=e.BUBBLES_COUNT,this.gameManager.bubbleArray=[];for(let i=0;i<e.BUBBLES_COUNT;i++){const s=i===0?e.BUBBLE_RADIUS_ONE||e.BUBBLE_RADIUS:e.BUBBLE_RADIUS_TWO||e.BUBBLE_RADIUS;this.bubble=new u(this.gameManager.ctx,i,s,e.BUBBLE_CENTER_X,e.BUBBLE_CENTER_Y),this.gameManager.bubbleArray.push(this.bubble)}this.gameManager.initialSetup()}}class G{constructor(e){t(this,"canvas");t(this,"ctx");t(this,"player");t(this,"x");t(this,"y");t(this,"bgImage");t(this,"bubble");t(this,"ground");t(this,"gameState");t(this,"bubblePlayerDx");t(this,"bubblePlayerDy");t(this,"bubblePlayerDistance");t(this,"bubbleArrowDx");t(this,"bubbleArrowDy");t(this,"bubbleArrowDistance");t(this,"arrow");t(this,"arrowActive");t(this,"numberOfBubbles");t(this,"bubbleRadius");t(this,"tempMovement");t(this,"isBubbleArrowCollisionTrue");t(this,"bubbleArray");t(this,"levelLoader");t(this,"timeLimit");t(this,"elapsedTime");t(this,"startTime");t(this,"timeRemaining");this.canvas=e,this.ctx=this.canvas.getContext("2d"),this.canvas.width=o.CANVAS_WIDTH,this.canvas.height=o.CANVAS_HEIGHT,this.levelLoader=new U(this),this.x=0,this.y=0,this.gameState=l.RUNNING,this.bgImage=new Image,this.numberOfBubbles=1,this.bubbleArray=[],this.arrowActive=!1,this.tempMovement=n.STATIONARY,this.timeLimit=2*1e3*60,this.startTime=Date.now(),this.timeRemaining=this.timeLimit,this.elapsedTime=0,this.levelLoader.loadLevel(0),this.start(),document.addEventListener("keydown",i=>{i.code==="ArrowLeft"&&(this.player.movement=n.LEFT,this.tempMovement=n.LEFT),i.code==="ArrowRight"&&(this.player.movement=n.RIGHT,this.tempMovement=n.RIGHT)}),document.addEventListener("keyup",i=>{(i.code==="ArrowLeft"||i.code==="ArrowRight")&&(this.player.movement=n.STATIONARY,this.tempMovement=n.STATIONARY)}),document.addEventListener("keydown",i=>{i.code==="Space"&&(this.arrow=new P(this.ctx,this.player.posX),this.arrow.isHittable=!0,this.player.movement=n.STATIONARY)}),document.addEventListener("keyup",i=>{i.code==="Space"&&(this.player.movement=this.tempMovement)})}initialSetup(){this.player=new A(this.ctx),this.ground=new Y(this.ctx),u.bubbleArray=this.bubbleArray}draw(){switch(this.gameState){case l.RUNNING:this.runningStateRender(),this.drawTimer();break;case l.END:this.endGameStateRender();break}}drawTimer(){const e=Math.floor(this.timeRemaining/6e4),i=Math.floor(this.timeRemaining%6e4/1e3),s=`${e}:${i<10?"0":""}${i}`;this.ctx.font="24px Arial",this.ctx.fillStyle="white",this.ctx.fillText(s,this.canvas.width-100,50)}resetTimer(){this.startTime=Date.now(),this.elapsedTime=0,this.timeRemaining=this.timeLimit}runningStateRender(){var e,i,s,r;this.ctx.clearRect(this.x,this.y,o.CANVAS_WIDTH,o.CANVAS_HEIGHT),this.ctx.drawImage(this.bgImage,this.x,this.y,this.canvas.width,this.canvas.height),(e=this.arrow)==null||e.draw(),(i=this.player)==null||i.draw(),this.bubbleArray.forEach(h=>{console.log(`${u.bubbleArray.length}`),h.draw(h.centerX,h.centerY)}),(s=this.ground)==null||s.draw(),((r=this.bubbleArray)==null?void 0:r.length)==0&&this.levelLoader.loadNextLevel()}waitingStateRender(){this.gameState=l.WAITING,this.ctx.fillStyle="red",this.ctx.fillRect(100,100,100,100),this.levelLoader.loadNextLevel()}checkCollision(){this.bubbleArray.forEach(e=>{e.checkCollision(this.player.posX,this.player.posY,e.centerX,e.centerY,e.radius),e.isPlayerBubbleCollisionTrue&&(this.gameState=l.END,this.endGameStateRender())}),this.bubbleArray.forEach(e=>{var i;e.isBubbleArrowCollisionTrue=(i=this.arrow)==null?void 0:i.checkCollision(e.centerX,e.centerY,e.radius)})}endGameStateRender(){this.gameState=l.END,this.ctx.fillStyle="green",this.ctx.fillRect(100,100,100,100)}update(){var e,i;this.gameState===l.RUNNING&&(this.elapsedTime=Date.now()-this.startTime,this.timeRemaining=this.timeLimit-this.elapsedTime,this.timeRemaining<=0&&(this.gameState=l.END,this.endGameStateRender()),(e=this.player)==null||e.update(),this.bubbleArray.forEach((s,r)=>{var h;s.isBubbleArrowCollisionTrue&&this.arrow.isHittable&&this.arrow.isActive&&(s.radius<10?(h=this.bubbleArray)==null||h.splice(r,1):s.splitBubbles(),this.arrow.isActive=!1,this.arrow.isHittable=!1)}),this.bubbleArray.forEach(s=>{s.update()}),(i=this.arrow)==null||i.update())}start(){this.update(),this.draw(),this.checkCollision(),this.start=this.start.bind(this),requestAnimationFrame(this.start)}}const g=document.querySelector("#canvas");g.width=o.CANVAS_WIDTH;g.height=o.CANVAS_HEIGHT;g.style.border="1px solid black";new G(g);
